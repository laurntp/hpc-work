Loading rhel8/default-amp
  Loading requirement: dot rhel8/slurm singularity/current rhel8/global
    cuda/11.4 libpciaccess/0.16/gcc-9.4.0-6fonbj6
    libiconv/1.16/gcc-9.4.0-ahebbov libxml2/2.9.12/gcc-9.4.0-gnknt5e
    ncurses/6.2/gcc-9.4.0-aiirok7 hwloc/2.5.0/gcc-9.4.0-7sqomga
    libevent/2.1.12/gcc-9.4.0-hgny7cm numactl/2.0.14/gcc-9.4.0-52dwc6n
    cuda/11.4.0/gcc-9.4.0-3hnxhjt gdrcopy/2.2/gcc-9.4.0-e4igtfp
    knem/1.1.4/gcc-9.4.0-bpbxgva libnl/3.3.0/gcc-9.4.0-whwhrwb
    rdma-core/34.0/gcc-9.4.0-5eo5n2u ucx/1.11.1/gcc-9.4.0-lktqyl4
    openmpi/4.1.1/gcc-9.4.0-epagguv
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/condabin/conda
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/bin/conda
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/bin/conda-env
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/bin/activate
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/bin/deactivate
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/etc/profile.d/conda.sh
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/etc/fish/conf.d/conda.fish
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/shell/condabin/Conda.psm1
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/shell/condabin/conda-hook.ps1
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/lib/python3.7/site-packages/xontrib/conda.xsh
no change     /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/etc/profile.d/conda.csh
no change     /home/hpcpin1/.bashrc
No action taken.
flatpak: symbol lookup error: /lib64/libk5crypto.so.3: undefined symbol: EVP_KDF_ctrl, version OPENSSL_1_1_1b

     active environment : torch2
    active env location : /home/hpcpin1/.conda/envs/torch2
            shell level : 1
       user config file : /home/hpcpin1/.condarc
 populated config files : 
          conda version : 4.7.12
    conda-build version : not installed
         python version : 3.7.4.final.0
       virtual packages : __cuda=12.2
       base environment : /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh  (read only)
           channel URLs : https://repo.anaconda.com/pkgs/main/linux-64
                          https://repo.anaconda.com/pkgs/main/noarch
                          https://repo.anaconda.com/pkgs/r/linux-64
                          https://repo.anaconda.com/pkgs/r/noarch
          package cache : /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/pkgs
                          /home/hpcpin1/.conda/pkgs
       envs directories : /home/hpcpin1/.conda/envs
                          /usr/local/software/archive/linux-scientific7-x86_64/gcc-9/miniconda3-4.7.12.1-rmuek6r3f6p3v6fdj7o2klyzta3qhslh/envs
               platform : linux-64
             user-agent : conda/4.7.12 requests/2.31.0 CPython/3.7.4 Linux/4.18.0-477.21.1.el8_8.x86_64 rocky/8.8 glibc/2.28
                UID:GID : 45163:45169
             netrc file : None
           offline mode : False

Changed directory to /rds/user/hpcpin1/hpc-work/CL-Detection2023.

JobID: 26713560
======
Time: Thu  7 Sep 10:02:20 BST 2023
Running on master node: gpu-q-7
Current directory: /rds/user/hpcpin1/hpc-work/CL-Detection2023

Nodes allocated:
================
gpu-q-7

numtasks=1, numnodes=1, mpi_tasks_per_node=1 (OMP_NUM_THREADS=1)

Executing command:
==================
python step2_train_and_valid.py --train_csv_path='../SegProject/Datasets/Cytomine/Cephalo/Train' --valid_csv_path='../SegProject/Datasets/Cytomine/Cephalo/Val' --batch_size=4 --cuda_id=0 --save_model_dir='./model/' 

current directory : /rds/user/hpcpin1/hpc-work/CL-Detection2023
['/rds/user/hpcpin1/hpc-work/CL-Detection2023', '/rds/user/hpcpin1/hpc-work/SegProject', '/home/hpcpin1/.conda/envs/torch2/lib/python310.zip', '/home/hpcpin1/.conda/envs/torch2/lib/python3.10', '/home/hpcpin1/.conda/envs/torch2/lib/python3.10/lib-dynload', '/home/hpcpin1/.conda/envs/torch2/lib/python3.10/site-packages']
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [01:11<10:40, 71.12s/it] 20%|██        | 2/10 [01:11<03:57, 29.64s/it] 30%|███       | 3/10 [01:12<01:54, 16.38s/it] 40%|████      | 4/10 [01:12<01:00, 10.15s/it] 50%|█████     | 5/10 [01:13<00:33,  6.70s/it] 60%|██████    | 6/10 [01:14<00:18,  4.63s/it] 70%|███████   | 7/10 [01:14<00:09,  3.31s/it] 80%|████████  | 8/10 [01:15<00:04,  2.45s/it] 90%|█████████ | 9/10 [01:15<00:01,  1.88s/it]100%|██████████| 10/10 [01:16<00:00,  1.49s/it]100%|██████████| 10/10 [01:16<00:00,  7.66s/it]
Train epoch [1   /400 ], Loss: 5964.051400
Saving checkpoint model  ./model/checkpoint_epoch_0.pt
Validating....
Traceback (most recent call last):
  File "/rds/user/hpcpin1/hpc-work/CL-Detection2023/step2_train_and_valid.py", line 201, in <module>
    main(experiment_config)
  File "/rds/user/hpcpin1/hpc-work/CL-Detection2023/step2_train_and_valid.py", line 127, in main
    for (image, heatmap) in tqdm.tqdm(valid_loader):
NameError: name 'valid_loader' is not defined. Did you mean: 'val_loader'?
End Time: Thu  7 Sep 10:04:13 BST 2023
